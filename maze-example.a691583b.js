!function(){var t,r,e=function(t){return{x:t.x,y:t.y}};function n(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function o(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?n(Object(e),!0).forEach((function(r){i(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):n(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function i(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}(r=t||(t={})).WALL="WALL",r.ROAD="ROAD";var s=t.WALL,u=function(t){var r=t.position;return{type:s,eastType:s,southType:s,position:r}},c=function(r,e,n){return e in r&&n in t?o({},r,i({},e,n)):o({},r)},a=function(t){var r=t.type;return s===r},f=function(t){return t.position};function p(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function h(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?p(Object(e),!0).forEach((function(r){l(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):p(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function l(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function b(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var e=[],n=!0,o=!1,i=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done)&&(e.push(s.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return e}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(t){return function(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var v=function(t){for(var r=t.size,e=r.x,n=r.y,o=[],i=0;i<e;++i)for(var s=t[i],u=0;u<n;++u)o.push(s[u]);return o},d=function(t){var r=t.length,e=y(t);if(!r)return[void 0,e];var n=Math.floor(Math.random()*r);return[b(e.splice(n,1),1)[0],e]},w=t.ROAD,m=function(t,r,e,n){var o=O(t,r);return c(o,e,n)},g=function(t,r){var e=f(r),n=e.x,o=e.y;return h({},t,l({},n,h({},t[n],l({},o,r))))},O=function(t,r){var e=f(r),n=e.x,o=e.y;return h({},t[n][o])},_=function(t,r){var e=f(t),n=e.x,o=e.y,i=f(r),s=i.x,u=i.y;return n<s?["eastType",null]:o<u?["southType",null]:n>s?[null,"eastType"]:o>u?[null,"southType"]:[null,null]},x=function(t,r){for(var e=t.size,n=e.x,o=e.y,i=f(r),s=i.x,u=i.y,c=[],a=0,p=[[-1,0],[0,-1],[1,0],[0,1]];a<p.length;a++){var h=b(p[a],2),l=s+h[0],y=u+h[1];0<=l&&0<=y&&l<n&&y<o&&c.push(t[l][y])}return c},S=function(t,r){return function(e){for(var n=e.size,o=2*n.x+1,i=2*n.y+1,u=t.createImageData(o*r,i*r),c=u.data,p=u.data.length,h=0;h<p;++h)c[h]=3==h%4?j:0;var l,b,y=!0,d=!1,w=void 0;try{for(var m,g=v(e)[Symbol.iterator]();!(y=(m=g.next()).done);y=!0){var O=m.value,_=f(O),x=_.x,S=_.y,T=2*x+1,A=2*S+1;a(O)||E(c,P,T,A,r,o),b=void 0,b=O.eastType,s!==b&&E(c,P,T+1,A,r,o),l=void 0,l=O.southType,s!==l&&E(c,P,T,A+1,r,o)}}catch(t){d=!0,w=t}finally{try{y||null==g.return||g.return()}finally{if(d)throw w}}t.putImageData(u,0,0)}},E=function(t,r,e,n,o,i){for(var s=n*o,u=e*o,c=o*i,a=0;a<o;++a)for(var f=(s+a)*c,p=0;p<o;++p)for(var h=4*(f+u+p),l=0;l<4;++l)t[h+l]=r[l]},j=255,P=[j,j,j,j],T=function(t,r){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(t,r)};function A(t,r){function e(){this.constructor=t}T(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}function D(t){return"function"==typeof t}var k=!1,I={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;k=t},get useDeprecatedSynchronousErrorHandling(){return k}};function V(t){setTimeout((function(){throw t}),0)}var C={closed:!0,next:function(t){},error:function(t){if(I.useDeprecatedSynchronousErrorHandling)throw t;V(t)},complete:function(){}},H=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function R(t){return null!==t&&"object"==typeof t}var z=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,r){return r+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),M=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var r;return t.prototype.unsubscribe=function(){var r;if(!this.closed){var e=this._parentOrParents,n=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,e instanceof t)e.remove(this);else if(null!==e)for(var i=0;i<e.length;++i){e[i].remove(this)}if(D(n))try{n.call(this)}catch(t){r=t instanceof z?U(t.errors):[t]}if(H(o)){i=-1;for(var s=o.length;++i<s;){var u=o[i];if(R(u))try{u.unsubscribe()}catch(t){r=r||[],t instanceof z?r=r.concat(U(t.errors)):r.push(t)}}}if(r)throw new z(r)}},t.prototype.add=function(r){var e=r;if(!r)return t.EMPTY;switch(typeof r){case"function":e=new t(r);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof t)){var n=e;(e=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+r+" added to Subscription.")}var o=e._parentOrParents;if(null===o)e._parentOrParents=this;else if(o instanceof t){if(o===this)return e;e._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return e;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[e]:i.push(e),e},t.prototype.remove=function(t){var r=this._subscriptions;if(r){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}},t.EMPTY=((r=new t).closed=!0,r),t}();function U(t){return t.reduce((function(t,r){return t.concat(r instanceof z?r.errors:r)}),[])}var Y=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),L=function(t){function r(e,n,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=C;break;case 1:if(!e){i.destination=C;break}if("object"==typeof e){e instanceof r?(i.syncErrorThrowable=e.syncErrorThrowable,i.destination=e,e.add(i)):(i.syncErrorThrowable=!0,i.destination=new N(i,e));break}default:i.syncErrorThrowable=!0,i.destination=new N(i,e,n,o)}return i}return A(r,t),r.prototype[Y]=function(){return this},r.create=function(t,e,n){var o=new r(t,e,n);return o.syncErrorThrowable=!1,o},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},r}(M),N=function(t){function r(r,e,n,o){var i,s=t.call(this)||this;s._parentSubscriber=r;var u=s;return D(e)?i=e:e&&(i=e.next,n=e.error,o=e.complete,e!==C&&(D((u=Object.create(e)).unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(s))),s._context=u,s._next=i,s._error=n,s._complete=o,s}return A(r,t),r.prototype.next=function(t){if(!this.isStopped&&this._next){var r=this._parentSubscriber;I.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable?this.__tryOrSetError(r,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},r.prototype.error=function(t){if(!this.isStopped){var r=this._parentSubscriber,e=I.useDeprecatedSynchronousErrorHandling;if(this._error)e&&r.syncErrorThrowable?(this.__tryOrSetError(r,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(r.syncErrorThrowable)e?(r.syncErrorValue=t,r.syncErrorThrown=!0):V(t),this.unsubscribe();else{if(this.unsubscribe(),e)throw t;V(t)}}},r.prototype.complete=function(){var t=this;if(!this.isStopped){var r=this._parentSubscriber;if(this._complete){var e=function(){return t._complete.call(t._context)};I.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable?(this.__tryOrSetError(r,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}},r.prototype.__tryOrUnsub=function(t,r){try{t.call(this._context,r)}catch(t){if(this.unsubscribe(),I.useDeprecatedSynchronousErrorHandling)throw t;V(t)}},r.prototype.__tryOrSetError=function(t,r,e){if(!I.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{r.call(this._context,e)}catch(r){return I.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(V(r),!0)}return!1},r.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},r}(L);var $=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function W(){}function q(t){return t?1===t.length?t[0]:function(r){return t.reduce((function(t,r){return r(t)}),r)}:W}var B=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(r){var e=new t;return e.source=this,e.operator=r,e},t.prototype.subscribe=function(t,r,e){var n=this.operator,o=function(t,r,e){if(t){if(t instanceof L)return t;if(t[Y])return t[Y]()}return t||r||e?new L(t,r,e):new L(C)}(t,r,e);if(n?o.add(n.call(o,this.source)):o.add(this.source||I.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),I.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){I.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=r),!function(t){for(;t;){var r=t,e=r.closed,n=r.destination,o=r.isStopped;if(e||o)return!1;t=n&&n instanceof L?n:null}return!0}(t)?console.warn(r):t.error(r)}},t.prototype.forEach=function(t,r){var e=this;return new(r=F(r))((function(r,n){var o;o=e.subscribe((function(r){try{t(r)}catch(t){n(t),o&&o.unsubscribe()}}),n,r)}))},t.prototype._subscribe=function(t){var r=this.source;return r&&r.subscribe(t)},t.prototype[$]=function(){return this},t.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return 0===t.length?this:q(t)(this)},t.prototype.toPromise=function(t){var r=this;return new(t=F(t))((function(t,e){var n;r.subscribe((function(t){return n=t}),(function(t){return e(t)}),(function(){return t(n)}))}))},t.create=function(r){return new t(r)},t}();function F(t){if(t||(t=I.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var G=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),J=function(t){function r(r,e){var n=t.call(this)||this;return n.subject=r,n.subscriber=e,n.closed=!1,n}return A(r,t),r.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,r=t.observers;if(this.subject=null,r&&0!==r.length&&!t.isStopped&&!t.closed){var e=r.indexOf(this.subscriber);-1!==e&&r.splice(e,1)}}},r}(M),K=function(t){function r(r){var e=t.call(this,r)||this;return e.destination=r,e}return A(r,t),r}(L),Q=function(t){function r(){var r=t.call(this)||this;return r.observers=[],r.closed=!1,r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return A(r,t),r.prototype[Y]=function(){return new K(this)},r.prototype.lift=function(t){var r=new X(this,this);return r.operator=t,r},r.prototype.next=function(t){if(this.closed)throw new G;if(!this.isStopped)for(var r=this.observers,e=r.length,n=r.slice(),o=0;o<e;o++)n[o].next(t)},r.prototype.error=function(t){if(this.closed)throw new G;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var r=this.observers,e=r.length,n=r.slice(),o=0;o<e;o++)n[o].error(t);this.observers.length=0},r.prototype.complete=function(){if(this.closed)throw new G;this.isStopped=!0;for(var t=this.observers,r=t.length,e=t.slice(),n=0;n<r;n++)e[n].complete();this.observers.length=0},r.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},r.prototype._trySubscribe=function(r){if(this.closed)throw new G;return t.prototype._trySubscribe.call(this,r)},r.prototype._subscribe=function(t){if(this.closed)throw new G;return this.hasError?(t.error(this.thrownError),M.EMPTY):this.isStopped?(t.complete(),M.EMPTY):(this.observers.push(t),new J(this,t))},r.prototype.asObservable=function(){var t=new B;return t.source=this,t},r.create=function(t,r){return new X(t,r)},r}(B),X=function(t){function r(r,e){var n=t.call(this)||this;return n.destination=r,n.source=e,n}return A(r,t),r.prototype.next=function(t){var r=this.destination;r&&r.next&&r.next(t)},r.prototype.error=function(t){var r=this.destination;r&&r.error&&this.destination.error(t)},r.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},r.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):M.EMPTY},r}(Q),Z=function(t){function r(r){var e=t.call(this)||this;return e._value=r,e}return A(r,t),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(r){var e=t.prototype._subscribe.call(this,r);return e&&!e.closed&&r.next(this._value),e},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new G;return this._value},r.prototype.next=function(r){t.prototype.next.call(this,this._value=r)},r}(Q),tt=function(t){return function(r){for(var e=0,n=t.length;e<n&&!r.closed;e++)r.next(t[e]);r.complete()}};function rt(t,r){return r?function(t,r){return new B((function(e){var n=new M,o=0;return n.add(r.schedule((function(){o!==t.length?(e.next(t[o++]),e.closed||n.add(this.schedule())):e.complete()}))),n}))}(t,r):new B(tt(t))}var et=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return A(r,t),r.prototype.notifyNext=function(t,r,e,n,o){this.destination.next(r)},r.prototype.notifyError=function(t,r){this.destination.error(t)},r.prototype.notifyComplete=function(t){this.destination.complete()},r}(L),nt=function(t){function r(r,e,n){var o=t.call(this)||this;return o.parent=r,o.outerValue=e,o.outerIndex=n,o.index=0,o}return A(r,t),r.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},r.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},r}(L);function ot(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var it=ot();var st=function(t){if(t&&"function"==typeof t[$])return n=t,function(t){var r=n[$]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(t)};if(function(t){return t&&"number"==typeof t.length&&"function"!=typeof t}(t))return tt(t);if(function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}(t))return e=t,function(t){return e.then((function(r){t.closed||(t.next(r),t.complete())}),(function(r){return t.error(r)})).then(null,V),t};if(t&&"function"==typeof t[it])return r=t,function(t){for(var e=r[it]();;){var n=e.next();if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof e.return&&t.add((function(){e.return&&e.return()})),t};var r,e,n,o=R(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function ut(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=t[t.length-1];return"function"==typeof e&&t.pop(),rt(t,void 0).lift(new ct(e))}var ct=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,r){return r.subscribe(new at(t,this.resultSelector))},t}(),at=function(t){function r(r,e,n){void 0===n&&(n=Object.create(null));var o=t.call(this,r)||this;return o.iterators=[],o.active=0,o.resultSelector="function"==typeof e?e:null,o.values=n,o}return A(r,t),r.prototype._next=function(t){var r=this.iterators;H(t)?r.push(new pt(t)):"function"==typeof t[it]?r.push(new ft(t[it]())):r.push(new ht(this.destination,this,t))},r.prototype._complete=function(){var t=this.iterators,r=t.length;if(this.unsubscribe(),0!==r){this.active=r;for(var e=0;e<r;e++){var n=t[e];if(n.stillUnsubscribed)this.destination.add(n.subscribe(n,e));else this.active--}}else this.destination.complete()},r.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},r.prototype.checkIterators=function(){for(var t=this.iterators,r=t.length,e=this.destination,n=0;n<r;n++){if("function"==typeof(s=t[n]).hasValue&&!s.hasValue())return}var o=!1,i=[];for(n=0;n<r;n++){var s,u=(s=t[n]).next();if(s.hasCompleted()&&(o=!0),u.done)return void e.complete();i.push(u.value)}this.resultSelector?this._tryresultSelector(i):e.next(i),o&&e.complete()},r.prototype._tryresultSelector=function(t){var r;try{r=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(r)},r}(L),ft=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),pt=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[it]=function(){return this},t.prototype.next=function(t){var r=this.index++,e=this.array;return r<this.length?{value:e[r],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),ht=function(t){function r(r,e,n){var o=t.call(this,r)||this;return o.parent=e,o.observable=n,o.stillUnsubscribed=!0,o.buffer=[],o.isComplete=!1,o}return A(r,t),r.prototype[it]=function(){return this},r.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},r.prototype.hasValue=function(){return this.buffer.length>0},r.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},r.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},r.prototype.notifyNext=function(t,r,e,n,o){this.buffer.push(r),this.parent.checkIterators()},r.prototype.subscribe=function(t,r){return function(t,r,e,n,o){if(void 0===o&&(o=new nt(t,e,n)),!o.closed)return r instanceof B?r.subscribe(o):st(r)(o)}(this,this.observable,this,r)},r}(et);var lt=function(){function t(t,r){this.predicate=t,this.thisArg=r}return t.prototype.call=function(t,r){return r.subscribe(new bt(t,this.predicate,this.thisArg))},t}(),bt=function(t){function r(r,e,n){var o=t.call(this,r)||this;return o.predicate=e,o.thisArg=n,o.count=0,o}return A(r,t),r.prototype._next=function(t){var r;try{r=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}r&&this.destination.next(t)},r}(L);function yt(t,r){return function(e){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return e.lift(new vt(t,r))}}var vt=function(){function t(t,r){this.project=t,this.thisArg=r}return t.prototype.call=function(t,r){return r.subscribe(new dt(t,this.project,this.thisArg))},t}(),dt=function(t){function r(r,e,n){var o=t.call(this,r)||this;return o.project=e,o.count=0,o.thisArg=n||o,o}return A(r,t),r.prototype._next=function(t){var r;try{r=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(r)},r}(L);function wt(t){return function(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function mt(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var e=[],n=!0,o=!1,i=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done)&&(e.push(s.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return e}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var gt=function(t){var r=mt(function(t,r,e){var n=b(_(r,e),2),o=n[0],i=n[1],s=t,u=r,c=e;return o?(u=m(s,u,o,w),s=g(s,u)):i&&(c=m(s,c,i,w),s=g(s,c)),c=m(s,c,"type",w),[s=g(s,c),c]}(t.map,t.from,t.to),2);return{map:r[0],to:r[1]}};function Ot(t){return function(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _t(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function xt(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function St(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var e=[],n=!0,o=!1,i=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done)&&(e.push(s.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return e}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Et=function(t){var r=St(t,2);return function(t){for(var r,e,n=t.waysToPave,o=t.map,i=n;;){var s=mt(d(i),2);if(r=s[0],i=s[1],!r)return;if(e=mt(d(x(o,r).filter(a)),1)[0]){i=[].concat(wt(i),[r]);break}}return{map:o,from:r,to:e,waysToPave:i}}({map:r[0],waysToPave:r[1]})},jt=function(t){var r=t.map,e=t.from,n=t.to,o=t.waysToPave;return function(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?_t(Object(e),!0).forEach((function(r){xt(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):_t(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}({},gt({map:r,from:e,to:n}),{waysToPave:o})},Pt=function(r){var n=function(t){for(var r=t.size,n=r.x,o=r.y,i={size:r},s=0;s<n;++s)for(var c=i[s]={},a=0;a<o;++a)c[a]=u({position:e({x:s,y:a})});return i}({size:r.size}),o=St(d(function(t){return v(t).filter(a)}(n)),1)[0];if(!o)throw new Error("failed to pick start cell.");o=c(o,"type",t.ROAD),n=g(n,o);var i,s,f=[o],p=new Z(n),h=new Z(f),l=new Z(1),b=ut(p,h).pipe(yt(Et),(i=function(t){return!!t},function(t){return t.lift(new lt(i,s))})),y=ut(b.pipe(yt(jt)),l).pipe(yt((function(t){return St(t,1)[0]})),yt((function(t){var r=t.map,e=t.to,n=t.waysToPave;p.next(r),h.next([].concat(Ot(n),[e]))}))).subscribe();return{map$:p.pipe(yt((function(t){return t}))),wayToPave$:b,paving$:y,pushNext:function(){l.next(1)}}};function Tt(t,r,e,n,o,i,s){try{var u=t[i](s),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}var At=function(){var t,r=(t=regeneratorRuntime.mark((function t(){var r,e,n,o,i,s,u,c,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=100,e=100,n=2,o=document.querySelector("canvas")){t.next=6;break}throw new Error("failed to find canvas");case 6:if(o.width=n*(2*r+1),o.height=n*(2*e+1),i=o.getContext("2d")){t.next=11;break}throw new Error("failed to get context");case 11:s=Pt({size:{x:r,y:e}}),u=s.map$,c=s.pushNext,u.subscribe(S(i,n)),a=1;case 14:return t.next=17,Dt(a);case 17:a=Math.max(.01,.9*a),c(),t.next=14;break;case 21:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function s(t){Tt(i,n,o,s,u,"next",t)}function u(t){Tt(i,n,o,s,u,"throw",t)}s(void 0)}))});return function(){return r.apply(this,arguments)}}(),Dt=function(t){return new Promise((function(r){return setTimeout(r,1e3*t)}))};At().catch(console.error.bind(console))}();