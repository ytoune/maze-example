const t=({x:t,y:r})=>({x:t,y:r});var r,e;(e=r||(r={})).WALL="WALL",e.ROAD="ROAD";const{WALL:n}=r,o=({position:t})=>({type:n,eastType:n,southType:n,position:t}),i=(t,e,n)=>e in t&&n in r?{...t,[e]:n}:{...t},u=({type:t})=>n===t,s=({eastType:t})=>n===t,c=({southType:t})=>n===t,a=({position:t})=>t,l=t=>{const{size:{x:r,y:e}}=t,n=[];for(let o=0;o<r;++o){const r=t[o];for(let t=0;t<e;++t)n.push(r[t])}return n},f=t=>{const{length:r}=t,e=[...t];if(!r)return[void 0,[]];const n=Math.floor(Math.random()*r),[o]=e.splice(n,1);return[o,e]},{ROAD:p}=r,h=(t,r,e,n)=>{const o=v(t,r);return i(o,e,n)},y=(t,r)=>{const{x:e,y:n}=a(r);return{...t,[e]:{...t[e],[n]:r}}},v=(t,r)=>{const{x:e,y:n}=a(r);return{...t[e][n]}},d=(t,r)=>{const{x:e,y:n}=a(t),{x:o,y:i}=a(r);return e<o?["eastType",null]:n<i?["southType",null]:e>o?[null,"eastType"]:n>i?[null,"southType"]:[null,null]},b=(t,r)=>{const{size:{x:e,y:n}}=t,{x:o,y:i}=a(r),u=[];for(const[r,s]of[[-1,0],[0,-1],[1,0],[0,1]]){const c=o+r,a=i+s;0<=c&&0<=a&&c<e&&a<n&&u.push(t[c][a])}return u},w=(t,r,e,n,o,i)=>{const u=n*o,s=e*o,c=o*i;for(let e=0;e<o;++e){const n=(u+e)*c;for(let e=0;e<o;++e){const o=4*(n+s+e);for(let e=0;e<4;++e)t[o+e]=r[e]}}},m=255,x=[m,m,m,m];
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _=function(t,r){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(t,r)};function g(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=t}_(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}function S(t,r,e,n){return new(e||(e=Promise))((function(o,i){function u(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var r;t.done?o(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(u,s)}c((n=n.apply(t,r||[])).next())}))}function T(t,r){var e,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};function s(i){return function(s){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=r.call(t,u)}catch(t){i=[6,t],n=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i}Object.create;function E(t){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function P(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,o,i=e.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(n=i.next()).done;)u.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u}function O(t,r){for(var e=0,n=r.length,o=t.length;e<n;e++,o++)t[o]=r[e];return t}function A(t){return this instanceof A?(this.v=t,this):new A(t)}function I(t,r,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=e.apply(t,r||[]),i=[];function u(t){o[t]&&(n[t]=function(r){return new Promise((function(e,n){i.push([t,r,e,n])>1||s(t,r)}))})}function s(t,r){try{(e=o[t](r)).value instanceof A?Promise.resolve(e.value.v).then(c,a):l(i[0][2],e)}catch(t){l(i[0][3],t)}var e}function c(t){s("next",t)}function a(t){s("throw",t)}function l(t,r){t(r),i.shift(),i.length&&s(i[0][0],i[0][1])}return n={},u("next"),u("throw"),u("return"),n[Symbol.asyncIterator]=function(){return this},n}function j(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,e=t[Symbol.asyncIterator];function n(e){r[e]=t[e]&&function(r){return new Promise((function(n,o){(function(t,r,e,n){Promise.resolve(n).then((function(r){t({value:r,done:e})}),r)})(n,o,(r=t[e](r)).done,r.value)}))}}return e?e.call(t):(t=E(t),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r)}Object.create;function k(t){return"function"==typeof t}function z(t){var r=t((function(t){Error.call(t),t.stack=(new Error).stack}));return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var C=z((function(t){return function(r){t(this),this.message=r?r.length+" errors occurred during unsubscription:\n"+r.map((function(t,r){return r+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=r}}));function D(t,r){if(t){var e=t.indexOf(r);0<=e&&t.splice(e,1)}}var L=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}var r;return t.prototype.unsubscribe=function(){var t,r,e,n,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var u=E(i),s=u.next();!s.done;s=u.next()){s.value.remove(this)}}catch(r){t={error:r}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}else i.remove(this);var c=this.initialTeardown;if(k(c))try{c()}catch(t){o=t instanceof C?t.errors:[t]}var a=this._teardowns;if(a){this._teardowns=null;try{for(var l=E(a),f=l.next();!f.done;f=l.next()){var p=f.value;try{M(p)}catch(t){o=null!=o?o:[],t instanceof C?o=O(O([],P(o)),P(t.errors)):o.push(t)}}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}}if(o)throw new C(o)}},t.prototype.add=function(r){var e;if(r&&r!==this)if(this.closed)M(r);else{if(r instanceof t){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._teardowns=null!==(e=this._teardowns)&&void 0!==e?e:[]).push(r)}},t.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},t.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},t.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&D(r,t)},t.prototype.remove=function(r){var e=this._teardowns;e&&D(e,r),r instanceof t&&r._removeParent(this)},t.EMPTY=((r=new t).closed=!0,r),t}(),N=L.EMPTY;function R(t){return t instanceof L||t&&"closed"in t&&k(t.remove)&&k(t.add)&&k(t.unsubscribe)}function M(t){k(t)?t():t.unsubscribe()}var U={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},F={setTimeout:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=F.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,O([],P(t)))},clearTimeout:function(t){var r=F.delegate;return((null==r?void 0:r.clearTimeout)||clearTimeout)(t)},delegate:void 0};function H(t){F.setTimeout((function(){var r=U.onUnhandledError;if(!r)throw t;r(t)}))}function Y(){}var $=W("C",void 0,void 0);function W(t,r,e){return{kind:t,value:r,error:e}}var V=null;function q(t){if(U.useDeprecatedSynchronousErrorHandling){var r=!V;if(r&&(V={errorThrown:!1,error:null}),t(),r){var e=V,n=e.errorThrown,o=e.error;if(V=null,n)throw o}}else t()}function G(t){U.useDeprecatedSynchronousErrorHandling&&V&&(V.errorThrown=!0,V.error=t)}var B=function(t){function r(r){var e=t.call(this)||this;return e.isStopped=!1,r?(e.destination=r,R(r)&&r.add(e)):e.destination=Z,e}return g(r,t),r.create=function(t,r,e){return new J(t,r,e)},r.prototype.next=function(t){this.isStopped?X(function(t){return W("N",t,void 0)}(t),this):this._next(t)},r.prototype.error=function(t){this.isStopped?X(W("E",void 0,t),this):(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped?X($,this):(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(L),J=function(t){function r(r,e,n){var o,i=t.call(this)||this;if(k(r))o=r;else if(r){var u;o=r.next,e=r.error,n=r.complete,i&&U.useDeprecatedNextContext?(u=Object.create(r)).unsubscribe=function(){return i.unsubscribe()}:u=r,o=null==o?void 0:o.bind(u),e=null==e?void 0:e.bind(u),n=null==n?void 0:n.bind(u)}return i.destination={next:o?K(o,i):Y,error:K(null!=e?e:Q,i),complete:n?K(n,i):Y},i}return g(r,t),r}(B);function K(t,r){return function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];try{t.apply(void 0,O([],P(r)))}catch(t){U.useDeprecatedSynchronousErrorHandling?G(t):H(t)}}}function Q(t){throw t}function X(t,r){var e=U.onStoppedNotification;e&&F.setTimeout((function(){return e(t,r)}))}var Z={closed:!0,next:Y,error:Q,complete:Y},tt="function"==typeof Symbol&&Symbol.observable||"@@observable";function rt(t){return t}function et(t){return 0===t.length?rt:1===t.length?t[0]:function(r){return t.reduce((function(t,r){return r(t)}),r)}}var nt=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(r){var e=new t;return e.source=this,e.operator=r,e},t.prototype.subscribe=function(t,r,e){var n,o=this,i=(n=t)&&n instanceof B||function(t){return t&&k(t.next)&&k(t.error)&&k(t.complete)}(n)&&R(n)?t:new J(t,r,e);return q((function(){var t=o,r=t.operator,e=t.source;i.add(r?r.call(i,e):e?o._subscribe(i):o._trySubscribe(i))})),i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},t.prototype.forEach=function(t,r){var e=this;return new(r=ot(r))((function(r,n){var o;o=e.subscribe((function(r){try{t(r)}catch(t){n(t),null==o||o.unsubscribe()}}),n,r)}))},t.prototype._subscribe=function(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)},t.prototype[tt]=function(){return this},t.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return et(t)(this)},t.prototype.toPromise=function(t){var r=this;return new(t=ot(t))((function(t,e){var n;r.subscribe((function(t){return n=t}),(function(t){return e(t)}),(function(){return t(n)}))}))},t.create=function(r){return new t(r)},t}();function ot(t){var r;return null!==(r=null!=t?t:U.Promise)&&void 0!==r?r:Promise}var it=z((function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),ut=function(t){function r(){var r=t.call(this)||this;return r.closed=!1,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return g(r,t),r.prototype.lift=function(t){var r=new st(this,this);return r.operator=t,r},r.prototype._throwIfClosed=function(){if(this.closed)throw new it},r.prototype.next=function(t){var r=this;q((function(){var e,n;if(r._throwIfClosed(),!r.isStopped){var o=r.observers.slice();try{for(var i=E(o),u=i.next();!u.done;u=i.next()){u.value.next(t)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}}))},r.prototype.error=function(t){var r=this;q((function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var e=r.observers;e.length;)e.shift().error(t)}}))},r.prototype.complete=function(){var t=this;q((function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}}))},r.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=null},Object.defineProperty(r.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),r.prototype._trySubscribe=function(r){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,r)},r.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},r.prototype._innerSubscribe=function(t){var r=this,e=r.hasError,n=r.isStopped,o=r.observers;return e||n?N:(o.push(t),new L((function(){return D(o,t)})))},r.prototype._checkFinalizedStatuses=function(t){var r=this,e=r.hasError,n=r.thrownError,o=r.isStopped;e?t.error(n):o&&t.complete()},r.prototype.asObservable=function(){var t=new nt;return t.source=this,t},r.create=function(t,r){return new st(t,r)},r}(nt),st=function(t){function r(r,e){var n=t.call(this)||this;return n.destination=r,n.source=e,n}return g(r,t),r.prototype.next=function(t){var r,e;null===(e=null===(r=this.destination)||void 0===r?void 0:r.next)||void 0===e||e.call(r,t)},r.prototype.error=function(t){var r,e;null===(e=null===(r=this.destination)||void 0===r?void 0:r.error)||void 0===e||e.call(r,t)},r.prototype.complete=function(){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===r||r.call(t)},r.prototype._subscribe=function(t){var r,e;return null!==(e=null===(r=this.source)||void 0===r?void 0:r.subscribe(t))&&void 0!==e?e:N},r}(ut),ct=function(t){function r(r){var e=t.call(this)||this;return e._value=r,e}return g(r,t),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),r.prototype._subscribe=function(r){var e=t.prototype._subscribe.call(this,r);return!e.closed&&r.next(this._value),e},r.prototype.getValue=function(){var t=this,r=t.hasError,e=t.thrownError,n=t._value;if(r)throw e;return this._throwIfClosed(),n},r.prototype.next=function(r){t.prototype.next.call(this,this._value=r)},r}(ut);var at="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function lt(t){if(t instanceof nt)return t;if(null!=t){if(function(t){return k(t[tt])}(t))return u=t,new nt((function(t){var r=u[tt]();if(k(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((i=t)&&"number"==typeof i.length&&"function"!=typeof i)return o=t,new nt((function(t){for(var r=0;r<o.length&&!t.closed;r++)t.next(o[r]);t.complete()}));if(k(null==(n=t)?void 0:n.then))return e=t,new nt((function(t){e.then((function(r){t.closed||(t.next(r),t.complete())}),(function(r){return t.error(r)})).then(null,H)}));if(function(t){return Symbol.asyncIterator&&k(null==t?void 0:t[Symbol.asyncIterator])}(t))return ft(t);if(function(t){return k(null==t?void 0:t[at])}(t))return r=t,new nt((function(t){var e,n;try{for(var o=E(r),i=o.next();!i.done;i=o.next()){var u=i.value;if(t.next(u),t.closed)return}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}t.complete()}));if(function(t){return k(null==t?void 0:t.getReader)}(t))return ft(function(t){return I(this,arguments,(function(){var r,e,n;return T(this,(function(o){switch(o.label){case 0:r=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,A(r.read())];case 3:return e=o.sent(),n=e.value,e.done?[4,A(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,A(n)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}}))}))}(t))}var r,e,n,o,i,u;throw function(t){return new TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(t)}function ft(t){return new nt((function(r){(function(t,r){var e,n,o,i;return S(this,void 0,void 0,(function(){var u,s;return T(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),e=j(t),c.label=1;case 1:return[4,e.next()];case 2:if((n=c.sent()).done)return[3,4];if(u=n.value,r.next(u),r.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=c.sent(),o={error:s},[3,11];case 6:return c.trys.push([6,,9,10]),n&&!n.done&&(i=e.return)?[4,i.call(e)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}}))}))})(t,r).catch((function(t){return r.error(t)}))}))}var pt=Array.isArray;function ht(t){return 1===t.length&&pt(t[0])?t[0]:t}var yt=new nt((function(t){return t.complete()}));var vt=function(t){function r(r,e,n,o,i){var u=t.call(this,r)||this;return u.onFinalize=i,u._next=e?function(t){try{e(t)}catch(t){r.error(t)}}:t.prototype._next,u._error=o?function(t){try{o(t)}catch(t){r.error(t)}finally{this.unsubscribe()}}:t.prototype._error,u._complete=n?function(){try{n()}catch(t){r.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,u}return g(r,t),r.prototype.unsubscribe=function(){var r,e=this.closed;t.prototype.unsubscribe.call(this),!e&&(null===(r=this.onFinalize)||void 0===r||r.call(this))},r}(B);function dt(t){return t[t.length-1]}function bt(t){return k(dt(t))?t.pop():void 0}function wt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=bt(t),n=ht(t);return n.length?new nt((function(t){var r=n.map((function(){return[]})),o=n.map((function(){return!1}));t.add((function(){r=o=null}));for(var i=function(i){lt(n[i]).subscribe(new vt(t,(function(n){if(r[i].push(n),r.every((function(t){return t.length}))){var u=r.map((function(t){return t.shift()}));t.next(e?e.apply(void 0,O([],P(u))):u),r.some((function(t,r){return!t.length&&o[r]}))&&t.complete()}}),(function(){o[i]=!0,!r[i].length&&t.complete()})))},u=0;!t.closed&&u<n.length;u++)i(u);return function(){r=o=null}})):yt}function mt(t){return function(r){if(function(t){return k(null==t?void 0:t.lift)}(r))return r.lift((function(r){try{return t(r,this)}catch(t){this.error(t)}}));throw new TypeError("Unable to lift unknown Observable type")}}function xt(t,r){return mt((function(e,n){var o=0;e.subscribe(new vt(n,(function(e){n.next(t.call(r,e,o++))})))}))}const _t=({map:t,from:r,to:e})=>{const[n,o]=((t,r,e)=>{const[n,o]=d(r,e);let i=t,u=r,s=e;return n?(u=h(i,u,n,p),i=y(i,u)):o&&(s=h(i,s,o,p),i=y(i,s)),s=h(i,s,"type",p),i=y(i,s),[i,s]})(t,r,e);return{map:n,to:o}},gt=([t,r])=>(({waysToPave:t,map:r})=>{let e,n,o=t;for(;;){if([e,o]=f(o),!e)return;if([n]=f(b(r,e).filter(u)),n){o=[...o,e];break}}return{map:r,from:e,to:n,waysToPave:o}})({map:t,waysToPave:r}),St=({map:t,from:r,to:e,waysToPave:n})=>({..._t({map:t,from:r,to:e}),waysToPave:n}),Tt=({size:e})=>{let n=(({size:r})=>{const{x:e,y:n}=r,i={size:r};for(let r=0;r<e;++r){const e=i[r]={};for(let i=0;i<n;++i)e[i]=o({position:t({x:r,y:i})})}return i})({size:e}),[s]=f(l(n).filter(u));if(!s)throw new Error("failed to pick start cell.");s=i(s,"type",r.ROAD),n=y(n,s);const c=[s],a=new ct(n),p=new ct(c),h=new ct(1),v=wt(a,p).pipe(xt(gt),(d=t=>!!t,mt((function(t,r){var e=0;t.subscribe(new vt(r,(function(t){return d.call(b,t,e++)&&r.next(t)})))}))));var d,b;const w=wt(v.pipe(xt(St)),h).pipe(xt((([t])=>t)),xt((({map:t,to:r,waysToPave:e})=>{a.next(t),p.next([...e,r])}))).subscribe();return{map$:a.pipe(xt((t=>t))),wayToPave$:v,paving$:w,pushNext:()=>{h.next(1)}}},Et=t=>new Promise((r=>setTimeout(r,1e3*t)));(async()=>{const t=document.querySelector("canvas");if(!t)throw new Error("failed to find canvas");t.width=402,t.height=402;const r=t.getContext("2d");if(!r)throw new Error("failed to get context");const{map$:e,pushNext:n}=Tt({size:{x:100,y:100}});e.subscribe(((t,r)=>e=>{const{size:{x:n,y:o}}=e,i=2*n+1,f=2*o+1,p=t.createImageData(i*r,f*r),{data:h,data:{length:y}}=p;for(let t=0;t<y;++t)h[t]=3==t%4?m:0;for(const t of l(e)){const{x:e,y:n}=a(t),o=2*e+1,l=2*n+1;u(t)||w(h,x,o,l,r,i),s(t)||w(h,x,o+1,l,r,i),c(t)||w(h,x,o,l+1,r,i)}t.putImageData(p,0,0)})(r,2));let o=1;for(;;)await Et(o),o=Math.max(.01,.9*o),n()})().catch(console.error.bind(console));